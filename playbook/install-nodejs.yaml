- name: install nvm and nodejs
  hosts: localhost
  tasks:
    - name: Install nvm
      shell: curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.2/install.sh | bash
      creates: /home/{{ ansible_user_id }}/.nvm/nvm.sh
    - name: Install node and set version
      shell: /bin/bash -c "source ~/.nvm/nvm.sh && nvm install stable && nvm alias default stable" #TODO parameterize
        creates=/home/{{ ansible_user_id }}/.nvm/alias
    - name: Install yarn
      shell: /bin/bash -c "source ~/.nvm/nvm.sh && npm install -g yarn"
      creates: /home/{{ ansible_user_id }}/.nvm/versions/node/stable/bin/yarn
